# 需求分析（PRD）- Place View 页面

**版本**: 2.0
**状态**: Draft
**关联**: epic/index.md（总需求）

## 1. 概述
- 问题陈述: 用户到达地点后需要快速理解"这个地方的故事是什么"以及其他用户的真实评价。
- 解决方案: Place View 以 Hero Moment 为核心，提供地点信息、评论列表与 Moments 入口。
- 范围（包含）:
  - Hero Moment 主视觉
  - 地点信息（根据类型动态展示）
  - 评论列表（KOL、朋友、网友分类）
  - Moments 列表与详情入口
  - Create Moment 弹框入口
  - App Clip 入口
- 范围（不包含）:
  - Moments 创建流程（由弹框单独处理）
  - Connections/Me 相关功能

## 2. 目标与成功指标
- 业务目标: 提升 Place View 进入率与内容解锁率。
- 用户目标: 快速理解地点氛围、查看真实评价并决定是否解锁或创建。
- 成功指标（KPIs）:
  - Place View 停留时长
  - 评论互动率（点赞、回复）
  - Moments 点击与解锁率
  - Create Moment 转化率

## 3. 用户与场景
- 目标用户/画像:
  - 到达地点的探索用户
  - 希望查看真实评价的决策用户
- 主要场景:
  - 从 Discover 进入 Place View
  - 线下扫描 Aura Code 进入 Place View
  - 查看地点信息并决定解锁或创建
- 边缘场景:
  - 无可用 Moment
  - 无评论数据
  - 网络慢导致主视觉加载失败

## 4. 需求
### 4.1 功能性需求
- FR-1 Hero Moment
  - 描述: 展示地点的主视觉循环内容。
  - 验收标准:
    - Given 页面加载完成, When Hero Moment 可用, Then 以全幅展示。
    
- FR-2 地点信息
  - 描述: 根据地点类型展示相关信息。
  - 类型映射:
    - 咖啡馆: 名称、地址、营业时间、价格区间、WiFi、座位数
    - 餐厅: 名称、地址、营业时间、价格区间、菜系、推荐菜品
    - 酒吧: 名称、地址、营业时间、价格区间、氛围、音乐类型
    - 书店: 名称、地址、营业时间、特色书籍、阅读区、活动
    - 艺术: 名称、地址、开放时间、展览信息、门票价格
    - 风景: 名称、地址、最佳观赏时间、难度、建议装备
    - 酒店: 名称、地址、价格区间、设施、房间数、评分
    - 市集: 名称、地址、开放时间、摊位数、特色商品
  - 验收标准:
    - Given 地点类型已知, When 显示信息, Then 展示对应字段。
    
- FR-3 评论列表
  - 描述: 分类展示 KOL、朋友、网友的评论。
  - 结构:
    - KOL 评论（置顶，带认证标识）
    - 朋友评论（次级位置，带关系标识）
    - 网友评论（按时间/热度排序）
  - 验收标准:
    - Given 评论可用, When 用户查看, Then 分类清晰可辨。
    - Given 评论可交互, When 用户点击点赞, Then 即时反馈。
    
- FR-4 Moments 列表
  - 描述: 展示可解锁 Moments 列表与摘要。
  - 类型支持:
    - Time Capsule（时间胶囊，视频内容）
    - AR Note（AR 笔记，绘制/文字）
    - Gift（礼物，支付解锁）
  - 验收标准:
    - Given 列表可用, When 下滑, Then 支持连续加载。
    - Given Moment 已锁定, When 点击, Then 显示解锁引导。
    
- FR-5 Create Moment 入口
  - 描述: 提供浮动按钮打开创建弹框。
  - 验收标准:
    - Given 用户点击创建按钮, When 弹框打开, Then 显示创建流程。
    
- FR-6 App Clip 入口
  - 描述: 提供快速体验入口。
  - 验收标准:
    - Given 用户未安装完整应用, When 点击入口, Then 打开 App Clip。

### 4.2 非功能性需求
- 性能: Hero 内容 1s 内可播放预览。
- 可靠性: 主视觉失败时降级为静态封面。
- 可访问性: 评分与内容可读性保障。

## 5. 用户体验
- 关键用户流程:
  - Discover → Place View → 查看信息与评论 → Unlock/Create Moment
- 信息架构:
  - Hero → 地点信息 → 评论列表 → Moments List → App Clip
- 交互模型:
  - 滚动浏览 + 点击进入详情 + 浮动按钮创建
- 内容模型:
  - Place（标题/位置/类型/信息）
  - Review（作者/内容/类型/时间）
  - Moment（标题/类型/作者/锁定状态）

## 6. 线框图（低保真）
- 线框 A [Place View V2]
```
┌─────────────────────────┐
│ Hero Moment              │
└─────────────────────────┘

┌─────────────────────────┐
│ Place Info (Dynamic)     │
│ Name / Address / Hours   │
│ Type-specific fields     │
└─────────────────────────┘

┌─────────────────────────┐
│ Reviews Section          │
│ [KOL] Review Card        │
│ [Friend] Review Card     │
│ [User] Review Card       │
└─────────────────────────┘

┌─────────────────────────┐
│ Moments Section          │
│ Time Capsule Card        │
│ AR Note Card             │
│ Gift Card                │
└─────────────────────────┘

┌─────────────────────────┐
│ App Clip Entry            │
└─────────────────────────┘

[Floating Action Button]
```
- 状态:
  - 空: 文案"这里暂时没有评论/Moment"，主操作"成为第一个"，次操作"返回"
  - 加载: 文案"正在点亮这里的气息…" + Hero 占位图 + 内容骨架
  - 错误: 文案"主视觉暂时缺席"，主操作"重试"，次操作"使用封面"
- 备注: 主视觉优先展示，评论与 Moments 为次级内容

## 7. HIG 对齐
| 原则 | 需求映射 | 备注 |
| --- | --- | --- |
| 清晰 | Hero 与信息结构明确 | 主视觉优先 |
| 克制 | 控件最少化 | 内容为主 |
| 层次 | 视觉层级明显 | 从 Hero 到评论到列表 |
| 审美一致性 | 电影感视觉与地点氛围一致 | 情绪匹配 |
| 一致性 | 列表与卡片样式统一 | 跨页复用 |
| 直接操作 | 点击卡片进入详情 | 路径清晰 |
| 反馈 | 评论点赞与点击反馈 | 即时响应 |
| 隐喻 | 浮动按钮暗示创建动作 | 易理解 |
| 用户可控 | 可随时返回与退出 | 可逆路径 |

## 8. 数据与分析
- 关键事件:
  - place_view_open, place_info_view
  - review_like, review_reply
  - moment_card_click, create_moment_open
  - app_clip_open

### 错误码与处理
| 错误码 | 场景 | 用户文案 | 行为 |
| --- | --- | --- | --- |
| PLACE_NET_UNAVAILABLE | 网络不可用 | "连接不到这里的故事" | 主操作"重试"，次操作"返回" |
| PLACE_CONTENT_EMPTY | 无可解锁内容 | "这里暂时没有可解锁的 Moment" | 主操作"创建第一个"，次操作"返回" |
| PLACE_HERO_LOAD_FAIL | 主视觉加载失败 | "主视觉暂时缺席" | 主操作"重试"，次操作"使用封面" |
| PLACE_APPCLIP_FAIL | App Clip 打开失败 | "App Clip 打不开" | 主操作"重试"，次操作"稍后再说" |

## 9. 风险与应对
- 风险: 主视觉加载失败
  - 应对: 静态封面与占位
- 风险: 评论过少影响决策
  - 应对: 引导创建与分享

## 10. 依赖与约束
- 依赖: 媒体服务、评论系统、App Clip
- 约束: 低网速需降级策略

## 11. 里程碑
- MVP: Hero + 地点信息 + 评论列表 + Moments 列表
- V1: Create Moment 弹框 + App Clip 入口
- Future: 更多交互与沉浸细节

## 12. 开放问题
- 评论排序算法是否需要个性化？
- 不同地点类型的信息字段是否需要可配置？

## 13. 假设
- 地点数据可用且可被策展
- 用户愿意查看和创建评论